<div class="admin-create-product-container">
  <form id="form-1" method="post" action="/admin/created" enctype="multipart/form-data">
    <div class="form-title">
      <p>Thêm sản phẩm mới</p>
    </div>

    <div class="form-group">
      <select name="categories">
        <option value="">-- Chọn Dòng Sản Phẩm --</option>
        <option value="skincare">Skincare</option>
        <option value="makeup">Makeup</option>
      </select>
    </div>

    <div class="form-group" style="display: none;">
      <select name="skincare">
        <option value="">-- Skincare --</option>
        <option value="xit-khoang">
          Xịt Khoáng
        </option>
        <option value="mat-na">
          Mặt Nạ
        </option>
        <option value="serum">
          Serum
        </option>
        <option value="bha">
          BHA
        </option>
        <option value="tay-da-chet">
          Tẩy Da Chết
        </option>
        <option value="duong-da">
          Dưỡng Da
        </option>  
        <option value="toner">
          Toner
        </option>
        <option value="nuoc-tay-trang">
          Nước Tẩy Trang
        </option>
        <option value="cham-mun">
          Chấm Mụn
        </option>
        <option value="kem-duong-am">
          Kem Dưỡng Ẩm
        </option>
        <option value="sua-rua-mat">
          Sữa Rửa Mặt
        </option>
      </select>
    </div>

    <div class="form-group" style="display: none;">
      <select name="makeup">
        <option value="">-- Makeup --</option>
        <option value="phan-ma">
          Phấn Má
        </option>
        <option value="mascara">
          Mascara
        </option>
        <option value="ke-mat">
          Kẻ Mắt
        </option>
        <option value="kem-chong-nang">
          Kem Chống Nắng
        </option>
        <option value="che-khuyet-diem">
          Che Khuyết Điểm
        </option>
        <option value="son">
          Son
        </option>
      </select>
    </div>

    <div class="form-group">
      <input type="text" class="form-control" id="brand" name="brand" placeholder="Hãng Sản Phẩm">
      <span class="form-message"></span>
    </div>

    <div class="form-group">
      <input type="text" class="form-control" id="name" name="name" placeholder="Tên Sản phẩm">
      <span class="form-message"></span>
    </div>

    <div class="form-group">
      <input type="text" class="form-control" id="price" name="price" placeholder="Giá Sản Phẩm">
      <span class="form-message"></span>
    </div>

    <div class="form-group">
      <input type="text" class="form-control" id="description" name="description" placeholder="Giới Thiệu Sản Phẩm">
      <span class="form-message"></span>
    </div>

    <div class="form-group">
      <input type="text" class="form-control" id="details" name="details" placeholder="Chi tiết Sản Phẩm">
      <span class="form-message"></span>
    </div>

    <div class="form-group">
      <select name="hotsale">
        <option value="no">-- Tình Trạng Sản Phẩm --</option>
        <option value="no">Bình thường</option>
        <option value="flash-sale">Đang Flash Sale</option>
        <option value="hot">Đang hot</option>
        <option value="out-of-order">Hết Hàng</option>
      </select>
    </div>

    <div class="form-group">
      <select name="newArrival">
        <option value="no">-- Hàng Mới Về --</option>
        <option value="no">Không</option>
        <option value="yes">Chuẩn luôn, mới về</option>
      </select>
    </div>

    <div class="form-group">
      <label>Ảnh Sản Phẩm</label>
      <input type="file" name="avatar" id="avatar"/>
    </div>
    <div class="submit-button">
      <button title="submit" type="submit">Đăng</button>
    </div>

  </form>
</div>

<script>  
// executing validate
function validating(inputElement, rule, checkValidate, index) {
  var errorMessage = rule.test(inputElement.value)
  var errorElement = inputElement.parentElement.querySelector('.form-message')

  if (errorMessage) {
    errorElement.innerText = errorMessage
    inputElement.style.border = '2px solid red'
    inputElement.parentElement.style.color = 'red'
    checkValidate[index] = false
  } else {
    errorElement.innerText = ''
    inputElement.style.border = 'none'
    inputElement.parentElement.style.color = 'black'
    checkValidate[index] = true
  }
}  

// isRequiredString requires input must have string
function isRequiredString(selector) {
  return {
    selector: selector,
    test: function (value) {
      return value.trim() ? undefined : 'Chưa Nhập Kìa =((('
    }
  }
}

// isRequiredNumber requires input must have number
function isRequiredNumber(selector) {
  return {
    selector: selector,
    test: function (value) {
      return value > 0 ? undefined : 'Chưa Nhập Tiền Kìa =((('
    }
  }
}

// validator function to validate input form from user
function validator(options) {
  var formElement = document.querySelector(options.form)
  var checkValidate = Array(5).fill(false)

  options.rules.forEach(function (rule, index) {
    var inputElement = formElement.querySelector(rule.selector)
    // input blur
    inputElement.onblur = function () {
      validating(inputElement, rule, checkValidate, index)
    }
  })

  formElement.onsubmit = function (e) {
    for (var i = 0; i < checkValidate.length; ++i) {
      if(checkValidate[i] === false) {
        e.preventDefault()
        options.rules.forEach(function (rule, index) {
          var inputElement = formElement.querySelector(rule.selector)
          validating(inputElement, rule, checkValidate, index)
        })
        break
      }
    }
  }
}

validator({
  form: '#form-1',
  errorSelector: '.form-message',
  rules: [
    isRequiredString('#brand'),
    isRequiredString('#name'),
    isRequiredNumber('#price'),
    isRequiredString('#description'),
    isRequiredString('#details'),
  ]
})

// skincare and makeup visibility
var selectBox = document.querySelector('select[name="categories"]')
var selectedValue = ''
var skincareBox = document.querySelector('select[name="skincare"]').parentElement
var makeUpBox = document.querySelector('select[name="makeup"]').parentElement

selectBox.onchange = function() {
  selectedValue = selectBox.options[selectBox.selectedIndex].value;
  if (selectedValue === 'skincare') {
    skincareBox.style.display = 'block'
    makeUpBox.style.display = 'none'
  }
  if (selectedValue === 'makeup') {
    skincareBox.style.display = 'none'
    makeUpBox.style.display = 'block'
  }
}

</script>